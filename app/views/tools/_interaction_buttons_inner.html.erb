<% state_upvote   = interaction_button_state(tool, current_user, :upvote) %>
<% state_favorite = interaction_button_state(tool, current_user, :favorite) %>
<% state_follow   = interaction_button_state(tool, current_user, :follow) %>

<div class="interaction-item d-flex flex-column align-items-center gap-1">
  <%= button_to upvote_tool_path(tool),
                method: :post,
                class: state_upvote[:btn_class],
                title: t("tools.actions.upvote"),
                aria: { label: t("tools.actions.upvote") } do %>
    <i class="<%= state_upvote[:icon_class] %> <%= state_upvote[:active] ? 'text-primary' : 'text-secondary' %>"></i>
  <% end %>
  <span class="interaction-count" title="<%= t('tools.actions.upvote') %>" aria-label="<%= t('tools.actions.upvote') %>">
    <%= tool.upvote_count %>
  </span>
</div>

<div class="interaction-item d-flex flex-column align-items-center gap-1">
  <%= button_to favorite_tool_path(tool),
                method: :post,
                class: state_favorite[:btn_class],
                title: t("tools.actions.favorite"),
                aria: { label: t("tools.actions.favorite") } do %>
    <i class="<%= state_favorite[:icon_class] %> <%= state_favorite[:active] ? 'text-warning' : 'text-secondary' %>"></i>
  <% end %>
  <span class="interaction-count" title="<%= t('tools.actions.favorite') %>" aria-label="<%= t('tools.actions.favorite') %>">
    <%= tool.favorite_count %>
  </span>
</div>

<div class="interaction-item d-flex flex-column align-items-center gap-1">
  <%= button_to follow_tool_path(tool),
                method: :post,
                class: state_follow[:btn_class],
                title: t("tools.actions.follow"),
                aria: { label: t("tools.actions.follow") } do %>
    <i class="<%= state_follow[:icon_class] %> <%= state_follow[:active] ? 'text-secondary' : 'text-secondary' %>"></i>
  <% end %>
  <span class="interaction-count" title="<%= t('tools.actions.follow') %>" aria-label="<%= t('tools.actions.follow') %>">
    <%= tool.follower_count %>
  </span>
</div>

<% if user_signed_in? %>
  <div class="interaction-item d-flex flex-column align-items-center gap-1">
    <button type="button" 
            class="btn btn-outline-secondary btn-sm" 
            data-controller="add-to-list-button"
            data-action="click->add-to-list-button#open"
            data-add-to-list-button-tool-id-value="<%= tool.id %>"
            data-add-to-list-button-tool-name-value="<%= tool.tool_name %>"
            data-add-to-list-button-lists-value="<%= current_user.lists.map { |l| { id: l.id, name: l.list_name, has_tool: l.tools.include?(tool) } }.to_json %>">
      <i class="bi bi-list-ul"></i>
    </button>
    <span class="interaction-count">
      <%= tool.lists.where(user: current_user).count %>
    </span>
  </div>
<% end %>

