<%# Tools always have black border and subtle gray background %>
<div class="card mb-3 position-relative card-hover border-start border-4 border-primary"
     style="background-color: #f5f5f5;"
     data-controller="tool-card"
     data-tool-card-url-value="<%= tool_path(tool) %>"
     data-action="click->tool-card#navigate">
  <div class="card-body">
    <div class="row">
      <!-- Left content: title, description, tags -->
      <div class="col-12 col-lg-8">
        <div class="d-flex justify-content-between align-items-start mb-1">
          <h5 class="card-title mb-0">
            <% title_text = tool.tool_name %>
            <% if local_assigns[:index] %>
              <% title_text = "#{index + 1}. #{title_text}" %>
            <% end %>
            <%= link_to title_text, tool_path(tool), class: "text-decoration-none" %>
            <%# Tools are community-owned, no owner to display %>
          </h5>
        </div>
        <div class="card-description">
          <% description = tool.tool_description.presence || t("pages.home.card.description", index: 1) %>
          <p class="card-text text-muted">
            <%= description %>
          </p>
        </div>
        <div class="d-flex flex-wrap gap-2" data-controller="tooltip">
          <% displayed_tags = tool.tags.limit(3) %>
          <% if displayed_tags.any? %>
            <% displayed_tags.each do |tag| %>
              <%= render_tag_link(tag) %>
            <% end %>
            <% if tool.tags.count > 3 %>
              <% hidden_tags = tool.tags.offset(3) %>
              <% hidden_tag_names = hidden_tags.pluck(:tag_name).join(", ") %>
              <span class="badge bg-secondary text-white"
                    data-bs-toggle="tooltip"
                    data-bs-title="<%= hidden_tag_names %>"
                    data-bs-placement="top">
                +<%= tool.tags.count - 3 %>
              </span>
            <% end %>
          <% else %>
            <% [
              t("pages.home.card.sample_tag_one"),
              t("pages.home.card.sample_tag_two"),
              t("pages.home.card.sample_tag_three")
            ].each do |tag| %>
              <span class="badge bg-light text-primary border"><%= tag %></span>
            <% end %>
          <% end %>
        </div>
        <!-- Removed stretched-link to keep interaction buttons clickable without redirect -->
      </div>

      <!-- Right content: interaction buttons - top-right on desktop, bottom on mobile -->
      <div class="col-12 col-lg-4 d-flex justify-content-lg-end justify-content-start align-items-lg-start align-items-center gap-3 mt-3 mt-lg-0">
        <%= render "tools/interaction_buttons", tool: tool %>
      </div>
    </div>
    <span class="position-absolute bottom-0 end-0 mb-1 me-1">
      <%= render "tools/read_state", tool: tool %>
    </span>
  </div>
</div>

