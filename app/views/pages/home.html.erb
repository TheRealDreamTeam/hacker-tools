<!-- Full-width layout with side banners -->
<div class="container-fluid px-0" data-controller="home-page" 
     data-home-page-signed-in-value="<%= user_signed_in? %>"
     data-home-page-guest-message-value="<%= j t('pages.home.card.upvote_guest_alert') %>"
     data-home-page-upvotes-text-value="<%= j t('pages.home.card.upvotes', count: '%{count}') %>">
  <div class="row g-0">
    <!-- Left Ad Banner (columns 1-2) - extended inward toward main content -->
    <div class="col-lg-2 d-none d-lg-block side-banner ps-5 pe-5">
      <div class="card h-100 rounded-0 border-0 border-end position-relative overflow-hidden" style="border-radius: 0 !important; background-image: url('https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=300&h=800&fit=crop'); background-size: cover; background-position: center;">
        <div class="position-absolute top-0 start-0 w-100 h-100" style="background: linear-gradient(135deg, rgba(0, 0, 0, 0.6) 0%, rgba(0, 0, 0, 0.4) 100%);"></div>
        <div class="card-body d-flex flex-column align-items-center justify-content-center text-center p-3 position-relative z-1">
          <p class="fw-semibold mb-1 text-white">Sponsors</p>
          <p class="text-white-50 small mb-0"><%= t("pages.home.ads.supporting_text") %></p>
        </div>
      </div>
    </div>

    <!-- Main Content (columns 3-10) - adjusted for wider banners -->
    <div class="col-lg-8">
      <div class="container py-4">
  <!-- Hero section with heading and article cards -->
  <div class="row justify-content-center mb-4">
    <div class="col-12 col-lg-8">
      <div class="text-center mb-4">
        <p class="lead text-muted mb-3"><%= t("pages.home.hero.heading") %></p>
        <p class="text-muted mb-4"><%= t("pages.home.hero.subheading") %></p>
      </div>
      
      <!-- Article cards -->
      <div class="row g-3 mb-4">
        <div class="col-12 col-md-4">
          <%= link_to newest_articles_path, class: "card text-decoration-none card-hover h-100 overflow-hidden article-card" do %>
            <div class="card-body d-flex align-items-center justify-content-center position-relative" style="min-height: 120px; background-image: url('https://images.unsplash.com/photo-1555066931-4365d14bab8c?w=400&h=200&fit=crop'); background-size: cover; background-position: center;">
              <div class="position-absolute top-0 start-0 w-100 h-100" style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%);"></div>
              <h5 class="card-title mb-0 text-white position-relative z-1"><%= t("pages.home.hero.articles.newest") %></h5>
            </div>
          <% end %>
        </div>
        <div class="col-12 col-md-4">
          <%= link_to user_guide_path, class: "card text-decoration-none card-hover h-100 overflow-hidden article-card" do %>
            <div class="card-body d-flex align-items-center justify-content-center position-relative" style="min-height: 120px; background-image: url('https://images.unsplash.com/photo-1522071820081-009f0129c71c?w=400&h=200&fit=crop'); background-size: cover; background-position: center;">
              <div class="position-absolute top-0 start-0 w-100 h-100" style="background: linear-gradient(135deg, rgba(240, 147, 251, 0.8) 0%, rgba(245, 87, 108, 0.8) 100%);"></div>
              <h5 class="card-title mb-0 text-black fw-bold position-relative z-1 text-center"><%= t("pages.home.hero.articles.user_guide") %></h5>
            </div>
          <% end %>
        </div>
        <div class="col-12 col-md-4">
          <%= link_to about_us_path, class: "card text-decoration-none card-hover h-100 overflow-hidden article-card" do %>
            <div class="card-body d-flex align-items-center justify-content-center position-relative" style="min-height: 120px; background-image: url('https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=400&h=200&fit=crop'); background-size: cover; background-position: center;">
              <div class="position-absolute top-0 start-0 w-100 h-100" style="background: linear-gradient(135deg, rgba(79, 172, 254, 0.8) 0%, rgba(0, 242, 254, 0.8) 100%);"></div>
              <h5 class="card-title mb-0 text-black fw-bold position-relative z-1"><%= t("pages.home.hero.articles.about_us") %></h5>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="border-bottom mb-4"></div>

  <!-- Hero search bar centered within 8-grid width on large screens -->
  <div class="row justify-content-center mb-4">
    <div class="col-12 col-lg-8">
      <%= form_with url: root_path,
                    method: :get,
                    local: false,
                    data: { turbo_stream: true },
                    role: "search",
                    class: "row g-2 align-items-center" do |form| %>
        <div class="col-12 col-md-9">
          <%= form.search_field :query,
                                value: params[:query],
                                id: "tool-search-input",
                                class: "form-control form-control-lg",
                                placeholder: t("pages.home.search_placeholder"),
                                aria: { label: t("pages.home.search_placeholder") },
                                data: { action: "input->home-page#debounceSearch" } %>
        </div>
        <div class="col-12 col-md-3 d-grid">
          <%= form.submit t("actions.search"), class: "btn btn-primary btn-lg" %>
        </div>
        <!-- Hidden field to preserve category selection -->
        <%= hidden_field_tag :category, params[:category] || "trending" %>
      <% end %>
    </div>
  </div>

  <div class="border-bottom mb-4"></div>

  <!-- Category toggles to swap tool lists without full reload (JS-ready) -->
  <div class="row justify-content-center mb-4">
    <div class="col-12 col-lg-8">
      <div class="btn-group w-100" role="group" aria-label="<%= t('pages.home.category_aria_label') %>">
        <button type="button" class="btn btn-outline-primary <%= 'active' if @category == 'trending' %> category-toggle" data-category="trending" aria-pressed="<%= @category == 'trending' %>">
          <%= t("pages.home.categories.trending") %>
        </button>
        <button type="button" class="btn btn-outline-primary <%= 'active' if @category == 'new' %> category-toggle" data-category="new" aria-pressed="<%= @category == 'new' %>">
          <%= t("pages.home.categories.new_hot") %>
        </button>
        <button type="button" class="btn btn-outline-primary <%= 'active' if @category == 'upvoted' %> category-toggle" data-category="upvoted" aria-pressed="<%= @category == 'upvoted' %>">
          <%= t("pages.home.categories.most_upvoted") %>
        </button>
      </div>
    </div>
  </div>

  <!-- Three-column layout: side rails for promos and center column for unified cards -->
  <div class="row g-3 justify-content-center">
    <div class="col-12 col-lg-10">
      <% panels = { "trending" => @trending_items, "new" => @new_hot_items, "upvoted" => @most_upvoted_items } %>

      <% panels.each_with_index do |(panel, items), panel_idx| %>
        <div class="card shadow-sm mb-3 card-hover <%= 'd-none' unless @category == panel %>" data-category-panel="<%= panel %>" id="category-panel-<%= panel %>">
          <div class="card-body">
            <% if items.blank? %>
              <p class="text-muted mb-0"><%= t("pages.home.list_placeholder") %></p>
            <% else %>
              <% items.each_with_index do |item, i| %>
                <%= render partial: "unified_card", locals: { item: item, index: i } %>
              <% end %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
      </div>
    </div>

    <!-- Right Ad Banner (columns 11-12) - extended inward toward main content -->
    <div class="col-lg-2 d-none d-lg-block side-banner ps-5 pe-5">
      <div class="card h-100 rounded-0 border-0 border-start position-relative overflow-hidden" style="border-radius: 0 !important; background-image: url('https://images.unsplash.com/photo-1550751827-4bd374c3f58b?w=300&h=800&fit=crop'); background-size: cover; background-position: center;">
        <div class="position-absolute top-0 start-0 w-100 h-100" style="background: linear-gradient(135deg, rgba(0, 0, 0, 0.6) 0%, rgba(0, 0, 0, 0.4) 100%);"></div>
        <div class="card-body d-flex flex-column align-items-center justify-content-center text-center p-3 position-relative z-1">
          <p class="fw-semibold mb-1 text-white">Sponsors</p>
          <p class="text-white-50 small mb-0"><%= t("pages.home.ads.supporting_text") %></p>
        </div>
      </div>
    </div>
  </div>
</div>

